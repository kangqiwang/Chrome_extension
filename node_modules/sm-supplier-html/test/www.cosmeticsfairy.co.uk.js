
var should = require('should');
var Structure = require('../lib/structure.js')
const cache = require('../lib/cache')

describe('www.cosmeticsFairy.com', function() {    

    describe('In Stock Page', function() {

        var payload = {
            "pageType" : "product",
            "url" : "http://www.cosmeticsfairy.co.uk/make-up/maybelline-baby-lips-lip-balm-pina-colada-pow-21.html",
            "html": cache.load("http://www.cosmeticsfairy.co.uk/make-up/maybelline-baby-lips-lip-balm-pina-colada-pow-21.html")
        }

        it('should be true when product is in stock', function () {

           const inStockPage =  Structure(payload)
           inStockPage.name.should.be.equal("Maybelline Baby Lips Lip Balm Pina Colada Pow 21");
           inStockPage.price.should.be.equal("0.95");
           inStockPage.url.should.be.equal("http://www.cosmeticsfairy.co.uk/make-up/maybelline-baby-lips-lip-balm-pina-colada-pow-21.html");
           inStockPage.inStock.should.be.equal(true);
           should(inStockPage.stockLevel).be.equal(null);
           inStockPage.inStock.should.be.equal(true);
           //inStockPage.image.should.be.equal('https://s3.amazonaws.com/cdn.bitsandpieces.com/images/395/42768.jpg');
           inStockPage.country.should.be.equal('uk');            
        });


    

    });

    describe('Search page pagination', function() {

        var payload = {
            "pageType" : "pagination",
            "url" : "http://www.cosmeticsfairy.co.uk/make-up.html",
            "html": cache.load("http://www.cosmeticsfairy.co.uk/make-up.html")
        }

        it('should be true when number of items and pages correct', function () {

           const inStockPage =  Structure(payload)
           inStockPage.items.should.be.equal("30");
           inStockPage.pages.should.be.equal("3")
        });

    });    

    describe('Search page category', function() {

        var payload = {
            "pageType" : "category",
            "url" : "http://www.cosmeticsfairy.co.uk/make-up.html",
            "html": cache.load("http://www.cosmeticsfairy.co.uk/make-up.html")
        }

        it('should be true when number of items and pages correct', function () {

           const inStockPage =  Structure(payload)
           inStockPage.name.should.be.equal("Make Up");
        });

    });    
    describe('Search Page', function() {

        var payload = {
            "pageType" : "search",
            "url" : "https://www.tesco.com/groceries/en-GB/shop/home-and-ents/toys-and-games/toys",
            "html": cache.load("https://www.tesco.com/groceries/en-GB/shop/home-and-ents/toys-and-games/toys")
        }
        var x=30
        it('should return'+x+' numer of products', function () {

           const inStockPage =  Structure(payload)
           inStockPage.length.should.equal(x)
            


            var first=inStockPage.shift()
            first.name.should.be.equal("Loreal Color Riche Mono Eyeshadow The Big Blue 405");
            first.price.should.be.equal("0.49");
            first.url.should.be.equal("http://www.cosmeticsfairy.co.uk/make-up/loreal-color-riche-mono-eyeshadow-the-big-blue-405.html");
            first.country.should.be.equal('uk');

            var last=inStockPage.pop()

            last.name.should.be.equal("Loreal Infallible Sexy Balm Lips Yala Yolo 203");
            last.price.should.be.equal("0.99");
            last.url.should.be.equal("http://www.cosmeticsfairy.co.uk/make-up/loreal-infallible-sexy-balm-lips-yala-yolo-203.html");
            last.country.should.be.equal('uk');            

        });
        
    });

})
