const should = require('should');
const saveJobReversePayload = require('../lib/saveJobReversePayload');
const tk = require('timekeeper')
var time = new Date(1528107831000);
tk.freeze(time);

describe('Reverse Search Payload Test', () => {

    it('should create reverse search payload for single asin', () => {

        const saveJobPayload = saveJobReversePayload({
            country: 'us',
            asin: '0307103358',
            type: 'asin',
            userName: 'mike',
            userId: '585d5951cc787451ccefab7e'
        });

        saveJobPayload.status.should.be.equal("QUEUED");
        saveJobPayload.created.toISOString().should.be.equal("2018-06-04T10:23:51.000Z");
        saveJobPayload.jobType.should.be.equal('REVERSE_SEARCH');
        saveJobPayload.subType.should.be.equal('ASIN');
        saveJobPayload.data.length.should.be.equal(1);
        saveJobPayload.data[0].should.be.equal('0307103358');
        saveJobPayload.country.should.be.equal('us');
        saveJobPayload.userName.should.be.equal('mike');
        saveJobPayload.userId.should.be.equal('585d5951cc787451ccefab7e');
        saveJobPayload.name.should.be.equal('Single Asin 0307103358 - Reverse Search');
        saveJobPayload.idName.should.be.equal('mike-SINGLE_ASIN_0307103358_REVERSE_SEARCH-us-20180604-102351')

    });

    it('should create reverse search payload for multiple asins', () => {

        const saveJobPayload = saveJobReversePayload({
            country: 'us',
            asin: ['0307103358','B075MP3HVG'],
            type: 'asin',
            userName: 'mike',
            userId: '585d5951cc787451ccefab7e'
        });

        saveJobPayload.status.should.be.equal("QUEUED");
        saveJobPayload.created.toISOString().should.be.equal("2018-06-04T10:23:51.000Z");
        saveJobPayload.jobType.should.be.equal('REVERSE_SEARCH');
        saveJobPayload.subType.should.be.equal('ASIN');
        saveJobPayload.data.length.should.be.equal(2);
        saveJobPayload.data[0].should.be.equal('0307103358');
        saveJobPayload.data[1].should.be.equal('B075MP3HVG');
        saveJobPayload.country.should.be.equal('us');
        saveJobPayload.userName.should.be.equal('mike');
        saveJobPayload.userId.should.be.equal('585d5951cc787451ccefab7e');
        saveJobPayload.name.should.be.equal('2 Asins - Reverse Search');
        saveJobPayload.idName.should.be.equal('mike-2_ASINS_REVERSE_SEARCH-us-20180604-102351')
    });

});