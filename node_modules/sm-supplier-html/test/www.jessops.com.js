    var should = require('should');
    var Structure = require('../lib/structure.js')
    const cache = require('../lib/cache')

    describe('www.jessops.com', function () {


        describe('In stock Page', function () {

            var payload = {
                "pageType": "product",
                "url": "http://www.jessops.com/online.store/categories/Memory%20Cards/SDHC%20Cards/products/SanDisk/Extreme%20SDHC%2016GB%2090MBs%20Memory%20Card-97114/Show.html",
                "html": cache.load("http://www.jessops.com/online.store/categories/Memory%20Cards/SDHC%20Cards/products/SanDisk/Extreme%20SDHC%2016GB%2090MBs%20Memory%20Card-97114/Show.html")
            }

            it('should be true when product is in stock', function () {

                const inStockPage = Structure(payload)
                inStockPage.name.should.be.equal("SanDisk Extreme SDHC 16GB 90MB/s Memory Card");
                inStockPage.price.should.be.equal("24.99");
                inStockPage.url.should.be.equal("http://www.jessops.com/online.store/categories/Memory%20Cards/SDHC%20Cards/products/SanDisk/Extreme%20SDHC%2016GB%2090MBs%20Memory%20Card-97114/Show.html");
                inStockPage.inStock.should.be.equal(true);
                should(inStockPage.stockLevel).be.equal(null);
                inStockPage.inStock.should.be.equal(true);
                inStockPage.image.should.be.equal('http://www.jessops.com/ce-images/PRODUCT/PRODUCT_LARGE/ASANDDS275279009.jpg');
                inStockPage.country.should.be.equal('uk');
            });

        });

    });

    describe('Out of Stock Page', function () {

        var payload = {
            "pageType": "product",
            "url": "http://www.jessops.com/online.store/categories/Memory%20Cards/SDXC%20Cards/products/SanDisk/Extreme%20PRO%2016GB%20SDHC%20UHS-II%20Memory%20Card-90865/Show.html",
            "html": cache.load("http://www.jessops.com/online.store/categories/Memory%20Cards/SDXC%20Cards/products/SanDisk/Extreme%20PRO%2016GB%20SDHC%20UHS-II%20Memory%20Card-90865/Show.html")
        }

        it('should be false when a product is out of stock', function () {

            const inStockPage = Structure(payload)
            inStockPage.name.should.be.equal("SanDisk Extreme PRO 16GB SDHC UHS-II Memory Card");
            inStockPage.price.should.be.equal("24.97");
            inStockPage.url.should.be.equal(payload.url);
            inStockPage.inStock.should.be.equal(false);
            should(inStockPage.stockLevel).be.equal(null);
            inStockPage.image.should.be.equal('http://www.jessops.com/ce-images/PRODUCT/PRODUCT_LARGE/ASANDDS275272634.jpg');
            inStockPage.country.should.be.equal('uk');
        });

    });

    describe('Search page category', function () {

        var payload = {
            "pageType": "category",
            "url": "http://www.jessops.com/online.store/categories/Current%20Offers/sandisk/dslr/Show.html",
            "html": cache.load("http://www.jessops.com/online.store/categories/Current%20Offers/sandisk/dslr/Show.html")
        }

        it('should be true when number of items and pages correct', function () {

            const categoryPage = Structure(payload)
            categoryPage.name.should.be.equal("DSLR");
            categoryPage.url.should.be.equal(payload.url);
        });

        describe('Search Page', function () {

            var payload = {
                "pageType": "search",
                "url": "https://www.jessops.com/accessories/camera-accessories/accessory-kits?fh_start_index=0&fh_view_size=21",
                "html": cache.load("https://www.jessops.com/accessories/camera-accessories/accessory-kits?fh_start_index=0&fh_view_size=21")
            }
            var x = 21
            it('should return' + x + ' number of products', function () {

                const searchPage = Structure(payload)
                searchPage.length.should.equal(x)

                var first = searchPage.shift()
                first.name.should.be.equal("Jessops Compact 16GB Bundle - Medium");
                first.price.should.be.equal("97.46");
                first.url.should.be.equal("https://www.jessops.com/p/Jessops/Compact-16GB-Bundle---Medium-111256");
                first.image.should.be.equal("https://i.jessops.com/ce-images/product/product_enlarged/cjessga105292549.jpg");
                first.country.should.be.equal('uk');

                var last = searchPage.pop()
                last.name.should.be.equal("Tecno Action Camera Accessory Kit");
                last.price.should.be.equal("19.99");
                last.url.should.be.equal("https://www.jessops.com/p/Tecno/Action-Camera-Accessory-Kit-99895");
                first.image.should.be.equal("https://i.jessops.com/ce-images/product/product_enlarged/cjessga105292549.jpg");
                last.country.should.be.equal('uk');
            });

        });

    })