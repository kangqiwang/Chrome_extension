var elasticsearch = require('elasticsearch');

let hdl = {};

module.exports = (config, next) => {    

    let host = config.host.replace('http://','');
    
    if(hdl[host]=== undefined) {
    
        hdl[host] =  new elasticsearch.Client({
            host: config.host,
            keepAlive: true,
            keepAliveInterval: 1000,
            maxRetries: 300
        });
    }
    
    next(null, hdl[host]);
};

