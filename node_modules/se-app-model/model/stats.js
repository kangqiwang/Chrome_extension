const Base = require('../lib/es/base');

class Stats extends Base {

    constructor(config, country, today) {
        super(config, country + '-stats-' + today);
        this.country = country;
    }

    save(data, next) {
        
        this.createIndex(this.collection, 'stats', (err) => {
            if(err) {
                if(err.message.indexOf('resource_already_exists_exception') > 0) {
                    // IT IS OK IF IT ALREADY EXISTS
                    this.bulkRaw(data, next)                    
                } else {
                    next(err)
                }
            } else {
                console.log('CREATING INDEX - ' + this.collection)
                this.bulkRaw(data, next)                    
            }            
        })
    }

}

module.exports = Stats;
