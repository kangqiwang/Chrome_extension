module.exports = (client, next) => {
    scan(client, 0, next)
}

let result = [];

function scan(client, cursor, next) {
    
    client.scan(cursor, 'MATCH', '*', 'COUNT', '10', function (err, reply) {
        if (err) {
            throw err;
        }

        cursor = reply[0];
        result = result.concat(reply[1])

        if (cursor === '0') {
            return next(result);
        } else {            
            scan(client, cursor, next);
        }
    });
}
