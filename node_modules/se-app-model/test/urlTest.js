const should = require('should');
const UrlModel = require('../index.js').model.url
const config = {
                    db: "se",
                    host: "127.0.0.1",
                    port: 27017
                }

describe('Url Test', function() {

        it('should return vaild Urls for supplier as array', function(done) {
                var Url = new UrlModel(config)

                Url.findValid({
                    supplierId : "585933e8b531bd29e25a93de",
                    size: 10,
                    fields: { "url" : 1 }
                }, (err, result) => {
                    should(err).be.equal(null)
                    result.should.have.property('total')
                    result.should.have.property('records')
                    result.total.should.be.above(0)
                    result.records.length.should.be.equal(10)
                    console.log(result)
                    done();
                })

        })

        // it('should return vaild Urls for supplier as array', function(done) {
        //         var Url = new UrlModel(config)

        //         Url.findData({
        //             supplierId : "58593450d2b2122cab550f37",
        //             size: 10,
        //             fields: { "url" : 1, "data" : 1 }
        //         }, (err, result) => {
        //             should(err).be.equal(null)
        //             result.should.have.property('total')
        //             result.should.have.property('records')
        //             result.total.should.be.above(0)
        //             result.records.length.should.be.equal(10)
        //             console.log(result)
        //             done();
        //         })

        // })

        it('should update the status of the url', function(done) {
            var Url = new UrlModel(config)

            Url.updateStatus({
                id: "58bd803abfb038a40b368626",
                status: "TEST"
            },(err, result) => {
                should(err).be.equal(null)
                done();
            })
        })

        // it('should add a url to the collection', function(done) {
        //     var Url = new UrlModel(config)

        //     Url.insertUrl({
        //         supplierId: "58bd8020bfb038a40b368625",
        //         url: "hello.iamaurl.com",
        //     }, (err, result) => {
        //         should(err).be.equal(null);
        //         done();
        //     })
        // })

        // it('should delete all urls for one supplier', function(done) {
        //     var Url = new UrlModel(config)

        //     Url.deleteAllUrls({
        //         id: "58bd8020bfb038a40b368625"
        //     }, (err, result) => {
        //         should(err).be.equal(null);
        //         done();
        //     })
        // })

        it('should delete one url for one supplier', function(done) {
            var Url = new UrlModel(config)

            Url.deleteOneUrl({
                id: "59b15e0e9289507b5926941e"
            }, (err, result) => {
                should(err).be.equal(null);
                done();
            })
        })


})
