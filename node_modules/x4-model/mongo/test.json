{
    "query": {
        "bool": {
            "must": [
                {
                    "match": {
                        "chromeOpp": true
                    }
                },
                {
                    "match": {
                        "jobId": "5d5d4865677e5f70d84ead2c"
                    }
                },
                {
                    "range": {
                        "amazon.price": {
                            "gte": -2
                        }
                    }
                },
                {
                    "range": {
                        "amazon.details.profit": {
                            "gte": 1
                        }
                    }
                },
                {
                    "range": {
                        "amazon.details.ROI": {
                            "gte": 0
                        }
                    }
                },
                {
                    "range": {
                        "amazon.details.salesRank": {
                            "gte": -2,
                            "lte": 15000000
                        }
                    }
                },
                {
                    "range": {
                        "supplier.matchDistance": {
                            "lte": 1
                        }
                    }
                }
            ],
            "must_not": [
                {
                    "terms": {
                        "supplier.id": []
                    }
                },
                {
                    "terms": {
                        "_id": []
                    }
                },
                {
                    "match": {
                        "supplier.domain": "www.toysrus.co.uk"
                    }
                },
                {
                    "match": {
                        "supplier.domain": "www.toysrus.com"
                    }
                }
            ]
        }
    },
    "aggs": {
        "suppliers": {
            "terms": {
                "field": "supplier.domain",
                "size": 100
            }
        },
        "categories": {
            "terms": {
                "field": "amazon.category",
                "size": 100
            }
        },
        "brandRestrictions": {
            "terms": {
                "field": "amazon.brandRestrictionResults.resultCode"
            }
        },
        "uniqueIds": {
            "terms": {
                "field": "supplier.id",
                "size": 10000,
                "order": {
                    "salesRank": "asc"
                }
            },
            "aggs": {
                "salesRank": {
                    "min": {
                        "field": "amazon.details.salesRank"
                    }
                },
                "ordering": {
                    "terms": {
                        "field": "amazon.details.salesRank",
                        "size": 1000,
                        "order": {
                            "salesRank": "asc"
                        }
                    },
                    "aggs": {
                        "salesRank": {
                            "min": {
                                "field": "amazon.details.salesRank"
                            }
                        },
                        "recordId": {
                            "terms": {
                                "field": "_id"
                            }
                        }
                    }
                }
            }
        }
    },
    "sort": [
        {
            "amazon.details.salesRank": {
                "order": "asc"
            }
        }
    ]
}


{
    "query": {
        "bool": {
            "must": [
                {
                    "range": {
                        "amazon.price": {
                            "gte": 1
                        }
                    }
                },
                {
                    "range": {
                        "amazon.details.profit": {
                            "gte": 2
                        }
                    }
                },
                {
                    "range": {
                        "amazon.details.ROI": {
                            "gte": 20
                        }
                    }
                },
                {
                    "range": {
                        "amazon.details.salesRank": {
                            "gte": 1,
                            "lte": 1500000
                        }
                    }
                },
                {
                    "range": {
                        "supplier.matchDistance": {
                            "lte": 0.01
                        }
                    }
                }
            ],
            "must_not": [
                {
                    "terms": {
                        "supplier.id": []
                    }
                },
                {
                    "terms": {
                        "_id": []
                    }
                },
                {
                    "match": {
                        "chromeOpp": true
                    }
                },
                {
                    "match": {
                        "supplier.domain": "www.toysrus.co.uk"
                    }
                },
                {
                    "match": {
                        "supplier.domain": "www.toysrus.com"
                    }
                },
                {
                    "match": {
                        "amazon.category": "major_appliances_display_on_website"
                    }
                }
            ]
        }
    },
    "aggs": {
        "suppliers": {
            "terms": {
                "field": "supplier.domain",
                "size": 100
            }
        },
        "categories": {
            "terms": {
                "field": "amazon.category",
                "size": 100
            }
        },
        "brandRestrictions": {
            "terms": {
                "field": "amazon.brandRestrictionResults.resultCode"
            }
        },
        "uniqueIds": {
            "terms": {
                "field": "supplier.id",
                "size": 10000,
                "order": {
                    "salesRank": "asc"
                }
            },
            "aggs": {
                "salesRank": {
                    "min": {
                        "field": "amazon.details.salesRank"
                    }
                },
                "ordering": {
                    "terms": {
                        "field": "amazon.details.salesRank",
                        "size": 1000,
                        "order": {
                            "salesRank": "asc"
                        }
                    },
                    "aggs": {
                        "salesRank": {
                            "min": {
                                "field": "amazon.details.salesRank"
                            }
                        },
                        "recordId": {
                            "terms": {
                                "field": "_id"
                            }
                        }
                    }
                }
            }
        }
    },
    "sort": [
        {
            "amazon.details.salesRank": {
                "order": "asc"
            }
        }
    ]
}