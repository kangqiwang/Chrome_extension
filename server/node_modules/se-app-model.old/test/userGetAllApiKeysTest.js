const expect = require('chai').expect;
const UserModel = require('../model/user');
const mongodb = require('mongodb');

const config = {
    db: "sm",
    host: "localhost",
    port: 27017
};


describe('#USER: Get All Api Keys: ', () => {

    let user = new UserModel(config);
    let testId = '58ecdc5025b9832a5d30fb6f';
    let testUser = mongodb.ObjectID(testId);

    it('should return a list of API Keys', (done) => {
        user.getAllApiKeys('uk', [], (err, result) => {
            expect(err).to.equal(null);
            expect(result).to.be.an('array');
            done();
        });
    });

    it('should not return keys if the user is in the userIds list', (done) => {
        user.getAllApiKeys('uk', [testUser], (err, result) => {
            expect(err).to.equal(null);
            expect(result).to.be.an('array');
            let testResult = true;
            result.map((thisResult)=>{
                if (thisResult.id === testId){
                    testResult = false;
                }
            });
            expect(testResult).to.equal(true);
            done();
        });
    })


});
