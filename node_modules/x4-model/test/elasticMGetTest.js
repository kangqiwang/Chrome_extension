const should = require('should');
const Elastic = require('../index').elastic
const config = require('../config')

describe('Elastic MGET Test', () => {

    it('should return Data from the database using mget', function (done) {
        var es = new Elastic(config.es)
        es.mGet({
            index: 'get_competative_price_for_asin_us',
            type: 'get_competative_price_for_asin',
            body: {
                ids: ['B07BZFXQ9Z',
                    'B01N5RZ37G',
                    'B01N5RZ37G',
                    'B01ND16O25',
                    'B0798LCJK9',
                    'B00PFCT2R0'
                ]
            }
        }, (err, data) => {
            should(err).be.equal(undefined);
            data.docs.length.should.be.equal(6);
            console.log(JSON.stringify(data, null, 2))
            done();
        })

    })

})

function processResult(data, next) {
    console.log(data.hits.hits.length)
    // Call Next to get the next scrolls
    next();
}