const should = require('should');
const Elastic = require('../index').elastic
const config = {
    host: "127.0.0.1:9888"
}

describe('Elastic Test', () => {

    it('should return Data fromm the database', function (done) {
        var es = new Elastic(config)
        es.search({
            "index": "sm-activity-2018*",
            "_source": ["object.job.jobId", "object.job.progress"],
            "size": 1,
            "body": {
                "query": {
                    "bool": {
                        "must": [{
                            "match": {
                                "type": "Progress"
                            }
                        }, {
                            "match": {
                                "object.type": "job"
                            }
                        }, {
                            "match": {
                                "object.job.jobId": "5b1b081726dfc551a8bdf055"
                            }
                        }]
                    }
                },
                "sort": [{
                    "timestamp": {
                        "order": "desc"
                    }
                }]
            }
        }, (err, data) => {
            console.log(err)
            should(err).be.equal(undefined);
            console.log(JSON.stringify(data, null, 2))
            done();
        })


        // it('should return Data fromm the database', function (done) {
        //     var es = new Elastic(config)
        //     es.search({
        //         "index": "sm-activity-2018*",
        //         "_source": ["object.job.jobId", "object.job.progress"],
        //         "size": 1,
        //         "body": {
        //             "query": {
        //                 "bool": {
        //                     "must": [{
        //                         "match": {
        //                             "type": "Progress"
        //                         }
        //                     }, {
        //                         "match": {
        //                             "object.type": "job"
        //                         }
        //                     }, {
        //                         "match": {
        //                             "object.job.jobId": "5b1b081726dfc551a8bdf055"
        //                         }
        //                     }]
        //                 }
        //             }
        //         }

        //         //"sort": [{
        //        //     "timestamp": {
        //         //        "order": "desc"
        //         //    }
        //         //}]

        //     }, (err, data) => {
        //         console.log(err)
        //         should(err).be.equal(null);
        //         console.log(data)
        //     })

    })

})