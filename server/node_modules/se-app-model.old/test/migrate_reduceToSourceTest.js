const should = require('should');
const MigateModel = require('../index.js').model.migrate

const config = require('../config').es;

describe('Migrate Test _reduceToSource', function () {

    it('should return just the source of the results', function () {
        var Migrate = new MigateModel(config, {
            country: 'uk'
        })
        let source = Migrate._reduceToArrayOf('asin', [{
                _index: 'uk-www-toysrus-co-uk',
                _type: 'supplier',
                _id: '33d71d0819aa2cb35f0273dd2fe6e38e',
                _score: 0.9332121,
                _source: {
                    asin: 'B01N8TTXXS'
                }
            },
            {
                _index: 'uk-www-toysrus-co-uk',
                _type: 'supplier',
                _id: 'df33b54d4584564c436febee165abc6a',
                _score: 0.9332121,
                _source: {
                    asin: 'B00INUNSPS'
                }
            },
            {
                _index: 'uk-www-toysrus-co-uk',
                _type: 'supplier',
                _id: 'cf53964bffd62f73d794159777dd4520',
                _score: 0.9332121,
                _source: {
                    asin: 'B071Y42KTS'
                }
            },
            {
                _index: 'uk-www-toysrus-co-uk',
                _type: 'supplier',
                _id: 'f4f9c7d6a9a71740152f87bb6d912457',
                _score: 0.9332121,
                _source: {
                    asin: 'B00XHP3MLO'
                }
            },
            {
                _index: 'uk-www-toysrus-co-uk',
                _type: 'supplier',
                _id: '6c255dcc991bd7f29b61f2b86c28eab0',
                _score: 0.9332121,
                _source: {
                    asin: 'B016NF8ZOI'
                }
            },
            {
                _index: 'uk-www-toysrus-co-uk',
                _type: 'supplier',
                _id: '5cc23404224e182260af55348979eae8',
                _score: 0.9332121,
                _source: {
                    asin: 'B017OVOJ86'
                }
            }])

            source.length.should.be.equal(6)
            source[0].should.be.equal('B01N8TTXXS')

    })

})